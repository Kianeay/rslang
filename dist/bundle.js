(()=>{"use strict";var t=function(){return t=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},t.apply(this,arguments)};const e=function(e){var n=this;this.controller=e,this.store={},this.getStore=function(){return n.store},this.setStore=function(e){var r;for(var o in e)n.store=t(t({},n.store),((r={})[o]=e[o],r))}},n=function(){function t(t){this.type="text",this.type=t.type,this.onChange=t.onChange}return t.prototype.render=function(){var t=document.createElement("input");return t.type=this.type,t.className="input",this.onChange&&t.addEventListener("change",this.onChange.bind(this)),t},t}(),r=function(){function t(t){this.label="",this.label=t.label,this.onClick=t.onClick}return t.prototype.render=function(){var t=document.createElement("button");return t.textContent=this.label,t.className="button",this.onClick&&t.addEventListener("click",this.onClick.bind(this)),t},t}();var o=[{title:"Main",iconName:"Home.svg"},{title:"Textbook",iconName:"Square.svg"},{title:"Minigames",iconName:"games-icon.svg"},{title:"Statistics",iconName:"Chart.svg"}];const a=function(){function t(){}return t.prototype.closeMenu=function(){document.querySelector(".nav__close-wrap").classList.add("none"),document.querySelector(".nav__burger-wrap").classList.remove("none"),document.querySelectorAll(".menu__text").forEach((function(t){t.classList.add("none")})),document.querySelector(".nav").classList.remove("open"),document.querySelector(".nav__logout-wrap").classList.remove("none"),document.querySelector(".nav__logout").classList.add("none")},t.prototype.openMenu=function(){document.querySelector(".nav__close-wrap").classList.remove("none"),document.querySelector(".nav__burger-wrap").classList.add("none"),document.querySelectorAll(".menu__text").forEach((function(t){t.classList.remove("none")})),document.querySelector(".nav").classList.add("open"),document.querySelector(".nav__logout-wrap").classList.add("none"),document.querySelector(".nav__logout").classList.remove("none")},t.prototype.createCloseIcon=function(){var t=this,e=document.createElement("div");e.className="nav__close-wrap none";var n=document.createElement("img");return n.className="nav__close-img",n.src="src/assets/images/close.svg",e.append(n),e.addEventListener("click",(function(){return t.closeMenu()})),e},t.prototype.createBurgerIcon=function(){var t=this,e=document.createElement("div");e.className="nav__burger-wrap";var n=document.createElement("img");return n.className="nav__burger",n.src="src/assets/images/menu.svg",e.append(n),e.addEventListener("click",(function(){return t.openMenu()})),e},t.prototype.createIcon=function(t){var e=document.createElement("div");e.className="menu__icon-wrap";var n=document.createElement("img");return n.className="menu__img",n.src="src/assets/images/".concat(t),e.append(n),e},t.prototype.createLink=function(t){var e=t.iconName,n=t.title,r=document.createElement("li");r.className="menu__item";var o=document.createElement("a");o.className="menu__link";var a=document.createElement("span");return a.className="menu__text none",a.textContent=n,o.href="#".concat(n.toLowerCase()),o.append(this.createIcon(e),a),r.append(o),r},t.prototype.createLogoutBtn=function(){var t=new r({label:"Log out",onClick:function(){console.log("logout")}}).render();return t.className="nav__logout button none",t},t.prototype.createLogoutIcon=function(){var t=document.createElement("div");t.className="nav__logout-wrap";var e=document.createElement("img");return e.className="nav__logout-img",e.src="src/assets/images/logout.svg",t.append(e),t.addEventListener("click",(function(){return console.log("logout")})),t},t.prototype.render=function(){var t=this,e=document.createElement("nav");e.className="nav";var n=document.createElement("ul");return n.className="menu",o.forEach((function(e,r){n.append(t.createLink(e))})),e.append(this.createCloseIcon(),this.createBurgerIcon(),n,this.createLogoutBtn(),this.createLogoutIcon()),e},t}(),s=function(){function t(t){this.title="",this.text="",this.imgName="",this.title=t.title,this.text=t.text,this.imgName=t.imgName,this.onClick=t.onClick}return t.prototype.createPlayBtn=function(){var t=new r({label:"play",onClick:this.onClick}).render();return t.classList.add("minigame__start"),t},t.prototype.createIcon=function(){var t=document.createElement("div");t.className="minigame__icon-wrap";var e=document.createElement("img");return e.className="minigame__img",e.src="src/assets/images/".concat(this.imgName),t.append(e),t},t.prototype.createDescription=function(){var t=document.createElement("div");t.className="minigame__wrap";var e=document.createElement("div");e.className="minigame__info";var n=document.createElement("h3");n.className="minigame__title",n.textContent=this.title;var r=document.createElement("p");return r.className="minigame__text",r.textContent=this.text,e.append(n,r),t.append(e,this.createPlayBtn()),t},t.prototype.render=function(){var t=document.createElement("div");return t.className="minigame",t.append(this.createIcon(),this.createDescription()),t},t}(),i=function(){function t(){}return t.prototype.createLink=function(t,e){var n=document.createElement("a");return n.className="footer__link",n.textContent=t,n.href=e,n.target="_blank",n},t.prototype.createIcon=function(){var t=document.createElement("div");t.className="footer__icon-wrap";var e=document.createElement("img");return e.className="footer__img",e.src="src/assets/images/rs_school.svg",t.append(e),t},t.prototype.render=function(){var t=document.createElement("footer");t.className="footer";var e=document.createElement("div");e.className="footer__links";var n=document.createElement("p");return n.className="footer__year",n.textContent="2022",e.append(this.createLink("elMP","https://github.com/elMP"),this.createLink("Kianeay","https://github.com/Kianeay"),this.createLink("arteemm","https://github.com/arteemm")),t.append(this.createIcon(),e,n),t},t}(),c=function(){function t(t){this.difficultyLevelsCount=6,this.callback=t}return t.prototype.changeActiveDifficultyLevel=function(t){var e=t.parentElement;Array.from(e.children).forEach((function(t){t.classList.remove("difficulty__item-active")})),t.classList.add("difficulty__item-active")},t.prototype.createTitle=function(){var t=document.createElement("h3");return t.textContent="Vocabulary difficulty level",t.className="difficulty__title",t},t.prototype.createDifficultyList=function(){var t=Number(localStorage.getItem("textbook-difficulty"));"number"!=typeof t&&(t=0);var e=document.createElement("ul");e.className="difficulty__list";for(var n=0;n<this.difficultyLevelsCount;n+=1){var r;(r=document.createElement("li")).className="difficulty__item",r.textContent=String(n+1),r.setAttribute("data-num",String(n)),n===t&&r.classList.add("difficulty__item-active"),e.append(r)}return localStorage.getItem("userID")&&((r=document.createElement("li")).className="difficulty__item",r.classList.add("difficulty__item-hard"),r.textContent="!!!",r.setAttribute("data-num","hard"),e.append(r)),e},t.prototype.render=function(){var t=this,e=document.createElement("div");return e.className="difficulty",e.append(this.createTitle(),this.createDifficultyList()),e.addEventListener("click",(function(e){var n=e.target;if(n.classList.contains("difficulty__item")){t.changeActiveDifficultyLevel(n);var r=n.dataset.num;t.callback(r)}})),e},t}();var u,l=function(){return l=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},l.apply(this,arguments)},d=function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function s(t){try{c(r.next(t))}catch(t){a(t)}}function i(t){try{c(r.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,i)}c((r=r.apply(t,e||[])).next())}))},p=function(t,e){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}};!function(t){t.BASE_URL="https://react-learnwords2022.herokuapp.com/",t.WORDS_URL="https://react-learnwords2022.herokuapp.com/words",t.USERS_URL="https://react-learnwords2022.herokuapp.com/users",t.SIGNIN_URL="https://react-learnwords2022.herokuapp.com/signin"}(u||(u={}));var h=function(t,e){localStorage.setItem("token",t),localStorage.setItem("refreshToken",e)},m=function(t,e){return d(void 0,void 0,void 0,(function(){var n,r;return p(this,(function(o){switch(o.label){case 0:localStorage.getItem("token"),(n=l({},e)).headers?n.headers.Authorization="Bearer ".concat(localStorage.getItem("token")):n.headers={Authorization:"Bearer ".concat(localStorage.getItem("token"))},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(t,n)];case 2:return[2,o.sent()];case 3:return r=o.sent(),console.error(r.message),[3,4];case 4:return[2,null]}}))}))},f=function(t,e,n,r){return d(void 0,void 0,void 0,(function(){return p(this,(function(o){switch(o.label){case 0:switch(t.status){case 404:return[3,1];case 401:return[3,2];case 417:return[3,4];case 422:return[3,5];case 400:return[3,6];case 403:return[3,7]}return[3,8];case 1:return r&&r(),console.error("".concat(e," not found")),[3,9];case 2:return console.log("change token"),[4,(a=localStorage.getItem("userID"),d(void 0,void 0,void 0,(function(){var t,e;return p(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(u.USERS_URL,"/").concat(a,"/tokens"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("refreshToken"))}})];case 1:return(t=n.sent()).ok?[3,2]:(console.log("Вывести сообщение с просьбой войти или зарегистрироваться"),[3,4]);case 2:return[4,t.json()];case 3:e=n.sent(),h(e.token,e.refreshToken),n.label=4;case 4:return[2]}}))})))];case 3:return o.sent(),[3,9];case 4:return n&&n(),console.error("".concat(e," has been create")),[3,9];case 5:return console.error("Incorrect e-mail or password"),[3,9];case 6:return console.error("Bad request"),[3,9];case 7:return n&&n(),console.error("incorect email or password"),[3,9];case 8:console.error("uncaught error"),o.label=9;case 9:return[2]}var a}))}))},v=function(t,e,n){return d(void 0,void 0,void 0,(function(){var r,o;return p(this,(function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),[4,m(t,e)];case 1:return(r=a.sent()).ok||401!==r.status?[3,4]:[4,f(r,n)];case 2:return a.sent(),[4,m(t,e)];case 3:r=a.sent(),a.label=4;case 4:return r.ok?[4,r.json()]:(f(r,n),[2,null]);case 5:return[2,a.sent()];case 6:return o=a.sent(),console.error(o.message),[3,7];case 7:return[2,null]}}))}))},g=function(t){return d(void 0,void 0,void 0,(function(){return p(this,(function(e){switch(e.label){case 0:return[4,v("".concat(u.USERS_URL,"/").concat(t),{},"user")];case 1:return[2,e.sent()]}}))}))},w=function(t,e){return d(void 0,void 0,void 0,(function(){var n;return p(this,(function(r){switch(r.label){case 0:return[4,fetch("".concat(u.WORDS_URL,"?page=").concat(e,"&group=").concat(t))];case 1:return(n=r.sent()).ok?[3,2]:(f(n,"words"),[3,4]);case 2:return[4,n.json()];case 3:return[2,r.sent()];case 4:return[2,null]}}))}))},y=function(t){return d(void 0,void 0,void 0,(function(){var e;return p(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(u.WORDS_URL,"/").concat(t))];case 1:return(e=n.sent()).ok?[3,2]:(f(e,"words"),[3,4]);case 2:return[4,e.json()];case 3:return[2,n.sent()];case 4:return[2,null]}}))}))},_=function(t){return d(void 0,void 0,void 0,(function(){return p(this,(function(e){switch(e.label){case 0:return[4,v("".concat(u.USERS_URL,"/").concat(t,"/words"),{},"user Words")];case 1:return[2,e.sent()]}}))}))},b=function(t,e){return d(void 0,void 0,void 0,(function(){return p(this,(function(n){switch(n.label){case 0:return[4,v("".concat(u.USERS_URL,"/").concat(t,"/words/").concat(e),{},"user Words")];case 1:return[2,n.sent()]}}))}))},S=function(t,e,n){return d(void 0,void 0,void 0,(function(){return p(this,(function(r){switch(r.label){case 0:return[4,v("".concat(u.USERS_URL,"/").concat(t,"/words/").concat(e),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)},"user words")];case 1:return[2,r.sent()]}}))}))},E=function(t,e,n){return d(void 0,void 0,void 0,(function(){return p(this,(function(r){switch(r.label){case 0:return[4,v("".concat(u.USERS_URL,"/").concat(t,"/words/").concat(e),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)},"user words")];case 1:return[2,r.sent()]}}))}))},k=function(t){return d(void 0,void 0,void 0,(function(){return p(this,(function(e){switch(e.label){case 0:return[4,v("".concat(u.USERS_URL,"/").concat(t,"/statistics"),{},"user statistics")];case 1:return[2,e.sent()]}}))}))},x=function(t,e){return d(void 0,void 0,void 0,(function(){return p(this,(function(n){switch(n.label){case 0:return[4,v("".concat(u.USERS_URL,"/").concat(t,"/statistics"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)},"user statistics")];case 1:return[2,n.sent()]}}))}))},L=function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function s(t){try{c(r.next(t))}catch(t){a(t)}}function i(t){try{c(r.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,i)}c((r=r.apply(t,e||[])).next())}))},A=function(t,e){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}};const I=function(){function t(){}return t.prototype.changeWordInList=function(t,e){var n=document.querySelectorAll(".words__item");Array.from(n).forEach((function(n){t===n.dataset.id&&("difficult"===e&&(n.classList.add("words__item-hard"),n.classList.remove("words__item-learned"),n.setAttribute("data-status","difficult")),"simple"===e&&(n.classList.remove("words__item-hard"),n.removeAttribute("data-status")))}))},t.prototype.workWithDifficultWords=function(t){return L(this,void 0,void 0,(function(){var e,n,r,o,a,s;return A(this,(function(i){switch(i.label){case 0:return e=t.currentTarget,n=e.dataset,r=n.word,n.status,o=localStorage.getItem("userID"),e.classList.contains("word__simple")?[4,E(o,r,{optional:{status:"simple"}})]:[3,2];case 1:return i.sent(),e.textContent="It's difficult",e.classList.remove("word__simple"),this.changeWordInList(r,"simple"),[3,6];case 2:return a={status:"difficult",newWord:"false",sprint:{correctAnswers:0},audio:{correctAnswers:0}},[4,E(o,r,{optional:{status:"difficult"}})];case 3:return i.sent()?[3,5]:[4,S(o,r,{optional:a})];case 4:i.sent(),i.label=5;case 5:e.textContent="It's simple",e.classList.add("word__simple"),(s=document.querySelector(".word__learned")).textContent="I know it",s.classList.remove("word__notlearned"),this.changeWordInList(r,"difficult"),i.label=6;case 6:return[2]}}))}))},t.prototype.workWithLearnedWords=function(t){return L(this,void 0,void 0,(function(){var e,n,r;return A(this,(function(o){switch(o.label){case 0:return e=t.currentTarget,n=e.dataset.word,r=localStorage.getItem("userID"),[4,E(r,n,{optional:{status:"learned"}})];case 1:return o.sent()?[3,3]:[4,S(r,n,{optional:{status:"learned",newWord:"false",sprint:{correctAnswers:0},audio:{correctAnswers:0}}})];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))},t.prototype.loadCurrentWord=function(t,e){return void 0===e&&(e={}),L(this,void 0,void 0,(function(){var n,r,o;return A(this,(function(a){switch(a.label){case 0:return n=this,[4,y(t)];case 1:return n.word=a.sent(),document.querySelector(".word__image").src=u.BASE_URL+this.word.image,document.querySelector(".word__title").textContent=this.word.word,document.querySelector(".word__transcription").textContent=this.word.transcription,document.querySelector(".word__translate").textContent=this.word.wordTranslate,document.querySelector(".word__meaning").innerHTML=this.word.textMeaning,document.querySelector(".word__meaning-translate").textContent=this.word.textMeaningTranslate,document.querySelector(".word__example-paragraph").textContent="Example",document.querySelector(".word__example").innerHTML=this.word.textExample,document.querySelector(".word__example-translate").textContent=this.word.textExampleTranslate,localStorage.getItem("userID")&&((r=document.querySelector(".word__difficult")).setAttribute("data-word",this.word.id),"difficult"===e.status?(r.textContent="It's simple",r.classList.add("word__simple")):(r.textContent="It's difficult",r.classList.remove("word__simple")),(o=document.querySelector(".word__learned")).setAttribute("data-word",this.word.id),"learned"===e.status?(o.textContent="Need to repeat",o.classList.add("word__notlearned")):(o.textContent="I know it",o.classList.remove("word__notlearned"))),[2]}}))}))},t.prototype.render=function(){var t=this,e=document.createElement("div");e.className="word__container";var n=document.createElement("img");n.className="word__image",e.append(n);var o=document.createElement("h4");o.className="word__title",e.append(o);var a=document.createElement("p");a.className="word__transcription",e.append(a);var s=document.createElement("p");s.className="word__translate",e.append(s);var i=document.createElement("p");i.className="word__meaning",e.append(i);var c=document.createElement("p");c.className="word__meaning-translate",e.append(c);var u=document.createElement("p");u.className="word__example-paragraph",e.append(u);var l=document.createElement("p");l.className="word__example",e.append(l);var d=document.createElement("p");if(d.className="word__example-translate",e.append(d),localStorage.getItem("userID")){var p=document.createElement("div");p.className="word__buttons";var h=new r({label:"It's difficult",onClick:function(e){t.workWithDifficultWords(e)}}).render();h.classList.add("word__difficult"),p.append(h);var m=new r({label:"I know it!",onClick:function(e){t.workWithLearnedWords(e)}}).render();m.classList.add("word__learned"),p.append(m),e.append(p)}return e},t}(),C=function(){function t(t,e,n,r,o){this.listenerFunction=t,this.correctArray=e,this.incorrectArray=n,this.inRowCount=r,this.learnedWord=o,this.listenerFunction=t}return t.prototype.createTitle=function(){var t=document.createElement("div");return t.className="result__title",t.textContent="Result",t},t.prototype.createPlayAgainBtn=function(){return new r({label:"play again",onClick:this.listenerFunction}).render()},t.prototype.createCorrectAnswerCount=function(){var t=document.createElement("div");return t.className="result__correct-title",t.textContent="Correct Answers",t},t.prototype.createStatistics=function(){var t=document.createElement("div");t.className="result__statistic";var e=document.createElement("div");e.className="result__learned";var n=document.createElement("div");n.className="result__accuracy";var r=document.createElement("div");r.className="result__in-row",e.textContent="".concat(this.learnedWord).padStart(2,"0"),"00"===e.textContent&&(e.textContent=" 0");var o=this.correctArray.length+this.incorrectArray.length,a="".concat(Math.round(this.correctArray.length/o*100)).padStart(2,"0");return"00"===a&&(a=" 0"),n.textContent="".concat(a,"%"),r.textContent="".concat(this.inRowCount).padStart(2,"0"),"00"===r.textContent&&(r.textContent=" 0"),t.append(e,n,r),t},t.prototype.createIncorrectAnswerCount=function(){var t=document.createElement("div");return t.className="result__wrong-title",t.textContent="Mistakes",t},t.prototype.createContainerCorrect=function(){var t=document.createElement("div");return t.className="result__correct-container",t.append(this.createCorrectAnswerCount()),this.createAnswer(this.correctArray,t),t},t.prototype.createContainerWrong=function(){var t=document.createElement("div");return t.className="result__wrong-container",t.append(this.createStatistics(),this.createIncorrectAnswerCount()),this.createAnswer(this.incorrectArray,t),t},t.prototype.createAnswer=function(t,e){var n=this;t.forEach((function(t){var r=document.createElement("div");r.className="result__answer-container",r.append(n.playButton(t.audio),n.createAnswerText(t.word,t.wordTranslate)),e.append(r)}))},t.prototype.createAnswerText=function(t,e){var n=document.createElement("div");return n.className="result__answer-text",n.textContent="".concat(t," – ").concat(e),n},t.prototype.playButton=function(t){var e=new r({label:"",onClick:function(){var n=new Audio;n.src="https://react-learnwords2022.herokuapp.com/".concat(t),n.addEventListener("canplay",(function(){n.play(),e.disabled=!0})),n.addEventListener("ended",(function(){e.disabled=!1}))}}).render();return e.className="result__play-btn",e},t.prototype.buttonContainer=function(){var t=document.createElement("div");return t.className="result__btn-container",t.append(this.createPlayAgainBtn(),this.createButtonTextBook()),t},t.prototype.createButtonTextBook=function(){return new r({label:"textbook",onClick:function(){window.location.hash="#textbook"}}).render()},t.prototype.createContainer=function(){var t=document.createElement("div");return t.className="result__container",t.append(this.createContainerWrong(),this.createContainerCorrect()),t},t.prototype.createLoginBtn=function(){var t=new r({label:"Log in",onClick:function(){location.hash="#login"}}).render();return t.classList.add("main__login"),t},t.prototype.render=function(){var t=document.createElement("div");return t.className="result",t.append(this.createTitle(),this.createContainer(),this.buttonContainer()),localStorage.getItem("userID")||t.append(this.createLoginBtn()),t},t}(),N=function(){function t(t){this.pages=30,this.visiblePages=3,this.startPage=0,this.callback=t}return t.prototype.createPrevButton=function(){var t=document.createElement("div");return t.className="pagination__control",t.classList.add("pagination__control-prev"),t.textContent="<",t},t.prototype.createNextButton=function(){var t=document.createElement("div");return t.className="pagination__control",t.classList.add("pagination__control-next"),t.textContent=">",t},t.prototype.createMiddleButton=function(){var t=document.createElement("div");return t.className="pagination__control",t.classList.add("pagination__control-middle"),t.textContent="...",t},t.prototype.createPaginationItems=function(t){var e=Number(localStorage.getItem("textbook-page"));"number"!=typeof e&&(e=0);for(var n=0;n<this.pages;n+=1){n===this.visiblePages&&t.append(this.createMiddleButton());var r=document.createElement("div");r.className="pagination__item",r.setAttribute("data-num",String(n)),(n<this.visiblePages||n>=this.pages-this.visiblePages)&&r.classList.add("pagination__item-visible"),r.textContent=String(n+1),n===e&&r.classList.add("pagination__item-active"),t.append(r)}},t.prototype.changeActivePage=function(t){var e=t.parentElement;Array.from(e.children).forEach((function(t){t.classList.remove("pagination__item-active")})),t.classList.add("pagination__item-active")},t.prototype.refreshActivePage=function(t){var e=document.querySelectorAll(".pagination__item");Array.from(e).forEach((function(e,n){e.classList.remove("pagination__item-active"),String(n)===t&&e.classList.add("pagination__item-active")}))},t.prototype.render=function(){var t=this,e=document.createElement("div");return e.className="pagination",e.append(this.createPrevButton()),this.createPaginationItems(e),e.append(this.createNextButton()),e.addEventListener("click",(function(e){var n=e.target;if(n.classList.contains("pagination__item")){t.changeActivePage(n);var r=n.dataset.num;t.callback(r)}})),e},t}();var W=function(){return W=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},W.apply(this,arguments)},B=function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function s(t){try{c(r.next(t))}catch(t){a(t)}}function i(t){try{c(r.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,i)}c((r=r.apply(t,e||[])).next())}))},T=function(t,e){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}};const q=function(){function t(){this.getEmailInput=function(){return document.querySelector(".form__email")},this.getPasswordInput=function(){return document.querySelector(".form__password")},this.getNamedInput=function(){return document.querySelector(".form__user-name")},this.getLoginBtn=function(){return document.querySelector(".form__login-btn")},this.getSignupBtn=function(){return document.querySelector(".form__signup-btn")},this.getLogOutBtn=function(){return document.querySelector(".form__logout-btn")},this.getEmailMessage=function(){return document.querySelector(".form__invalid-email")},this.getPasswordMessage=function(){return document.querySelector(".form__invalid-password")},this.getErrorMessage=function(){return document.querySelector(".form__invalid__answer")},this.logoutNav=document.querySelector(".nav__logout"),this.logoutNavImage=document.querySelector(".nav__logout-wrap"),this.logIn=!1,this.logoutNav.addEventListener("click",this.logOutUser.bind(this)),this.logoutNavImage.addEventListener("click",this.logOutUser.bind(this))}return t.prototype.getUser=function(){return B(this,void 0,void 0,(function(){var t,e;return T(this,(function(n){switch(n.label){case 0:return t=localStorage.getItem("userID"),e=localStorage.getItem("refreshToken"),t&&e?[4,g(t)]:[3,2];case 1:n.sent()&&(this.clearInput(),this.changeButtons(),this.logIn=!0),n.label=2;case 2:return[2]}}))}))},t.prototype.createLogInBtn=function(){var t=new r({label:"Log In",onClick:this.logInUser.bind(this)}).render();return t.classList.add("form__login-btn","button_colored"),this.logIn&&t.classList.add("form__login-btn_scale-down"),t},t.prototype.createSignUpBtn=function(){var t=new r({label:"Sign Up",onClick:this.signUpUser.bind(this)}).render();return t.classList.add("form__signup-btn","button_colored","none"),this.logIn&&t.classList.add("form__signup-btn_scale-down"),t},t.prototype.createLogOutBtn=function(){var t=new r({label:"Log Out",onClick:this.logOutUser.bind(this)}).render();return t.classList.add("form__logout-btn","button_colored"),this.logIn&&t.classList.add("form__logout-btn_scale-up"),t},t.prototype.signUpUser=function(){return B(this,void 0,void 0,(function(){var t,e;return T(this,(function(n){switch(n.label){case 0:return t=this.checkInput(),e=this.getErrorMessage(),t?[4,(r=W({},t),o=function(){e.classList.remove("none"),e.textContent="User has been created"},d(void 0,void 0,void 0,(function(){var t;return p(this,(function(e){switch(e.label){case 0:return[4,fetch(u.USERS_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})];case 1:return(t=e.sent()).ok?[3,2]:(f(t,"user",o),[3,4]);case 2:return[4,t.json()];case 3:return[2,e.sent()];case 4:return[2,null]}}))})))]:[3,2];case 1:n.sent()&&this.logInUser(),n.label=2;case 2:return[2]}var r,o}))}))},t.prototype.logInUser=function(){return B(this,void 0,void 0,(function(){var t,e;return T(this,(function(n){switch(n.label){case 0:return t=this.checkInput(),e=this.getErrorMessage(),t?[4,(r=W({},t),o=function(){e.classList.remove("none"),e.textContent="Incorrect email or password"},a=function(){e.classList.remove("none"),e.textContent="User wasn't found"},d(void 0,void 0,void 0,(function(){var t,e;return p(this,(function(n){switch(n.label){case 0:return[4,fetch(u.SIGNIN_URL,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(r)})];case 1:return(t=n.sent()).ok?[3,2]:(f(t,"user",o,a),[3,4]);case 2:return[4,t.json()];case 3:return e=n.sent(),h(e.token,e.refreshToken),s=e.userId,localStorage.setItem("userID",s),[2,e];case 4:return[2,null]}var s}))})))]:[3,2];case 1:n.sent()&&this.getUser(),n.label=2;case 2:return[2]}var r,o,a}))}))},t.prototype.createNamedInput=function(){var t=new n({type:"text"}).render();return t.className="form__user-name none",t.required=!0,t},t.prototype.createPasswordInput=function(){var t=new n({type:"password",onChange:this.validatePassword.bind(this)}).render();return t.className="form__password",t.required=!0,t},t.prototype.createEmailInput=function(){var t=new n({type:"text",onChange:this.validateEmail.bind(this)}).render();return t.className="form__email",t.required=!0,t},t.prototype.checkInput=function(){var t=this.getEmailInput(),e=this.getPasswordInput(),n=this.getNamedInput(),r=t.value,o=e.value,a=n.value;return r.length||(t.classList.add("form__email_invalid"),this.getEmailMessage().classList.remove("none")),o.length||(e.classList.add("form__password_invalid"),this.getPasswordMessage().classList.remove("none")),!t.classList.contains("form__email_invalid")&&!e.classList.contains("form__password_invalid")&&(a?{name:a,email:r,password:o}:{email:r,password:o})},t.prototype.logOutUser=function(){this.logIn=!1,this.changeButtons(),localStorage.removeItem("userID"),localStorage.removeItem("token"),localStorage.removeItem("refreshToken")},t.prototype.changeButtons=function(){var t=this.getLoginBtn(),e=this.getSignupBtn(),n=this.getLogOutBtn();null!==t&&null!==e&&null!==n&&(t.classList.toggle("form__login-btn_scale-down"),e.classList.toggle("form__signup-btn_scale-down"),n.classList.toggle("form__logout-btn_scale-up")),this.logoutNav.classList.toggle("hidden"),this.logoutNavImage.classList.toggle("hidden")},t.prototype.clearInput=function(){var t=this.getEmailInput(),e=this.getPasswordInput(),n=this.getNamedInput();null!==t&&null!==e&&(t.value="",e.value=""),null!==n&&(n.value="")},t.prototype.validateEmail=function(t){var e=t.currentTarget,n=this.getEmailMessage();this.getErrorMessage().classList.add("none"),e.value.match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)?(e.classList.remove("form__email_invalid"),n.classList.add("none")):(n.classList.remove("none"),e.classList.add("form__email_invalid"))},t.prototype.validatePassword=function(t){var e=t.currentTarget,n=this.getPasswordMessage();this.getErrorMessage().classList.add("none"),e.value.length<8?(e.classList.add("form__password_invalid"),n.classList.remove("none")):(e.classList.remove("form__password_invalid"),n.classList.add("none"))},t.prototype.createLabel=function(t,e){var n=document.createElement("div"),r=document.createElement("label");return n.className="form__label-box ".concat(e),r.textContent=t,n.append(r),n},t.prototype.createLink=function(t,e){var n=document.createElement("span");return n.className="form__link ".concat(e),n.addEventListener("click",this.signInRender.bind(this)),n.textContent=t,n},t.prototype.signInRender=function(){var t=document.querySelector(".form__to-signup"),e=document.querySelector(".form__to-login"),n=document.querySelector(".form__label-name"),r=this.getNamedInput();t.classList.toggle("none"),e.classList.toggle("none"),this.getSignupBtn().classList.toggle("none"),r.classList.toggle("none"),n.classList.toggle("none"),this.getLoginBtn().classList.toggle("hidden")},t.prototype.createButtonsContainer=function(){var t=document.createElement("div");return t.className="form__buttons-container",t.append(this.createInvalidMessage("","form__invalid__answer"),this.createLogInBtn(),this.createLink("create account","form__to-signup"),this.createSignUpBtn(),this.createLink("back","form__to-login none"),this.createLogOutBtn()),t},t.prototype.createInputContainer=function(t,e,n){var r=document.createElement("div");return r.className="form__input-container",r.append(t,e,n),r},t.prototype.createTitle=function(){var t=document.createElement("p");return t.className="form__title",t.textContent="RS Lang",t},t.prototype.createLoginBackground=function(){var t=document.createElement("img");return t.className="form__img",t.src="src/assets/images/main.svg",t},t.prototype.createInvalidMessage=function(t,e){var n=document.createElement("span");return n.className="form__invalid-text none ".concat(e),n.textContent=t,n},t.prototype.createForm=function(){var t=document.createElement("div");return t.className="form",t.append(this.createTitle(),this.createInputContainer(this.createNamedInput(),this.createLabel("Enter your name","form__label-name none"),this.createInvalidMessage("incorrect name","form__invalid-name")),this.createInputContainer(this.createEmailInput(),this.createLabel("Enter your email","form__label-email"),this.createInvalidMessage("incorrect email","form__invalid-email")),this.createInputContainer(this.createPasswordInput(),this.createLabel("Enter password","form__label-password"),this.createInvalidMessage("short password, min length 8 characters","form__invalid-password")),this.createButtonsContainer()),t},t.prototype.render=function(){var t=document.createElement("div");return t.className="form-container",t.append(this.createForm(),this.createLoginBackground()),t},t}(),P=function(){function t(){}return t.prototype.createStartBtn=function(){var t=new r({label:"Let’s start",onClick:function(){location.hash="#textbook"}}).render();return t.classList.add("main__start"),t},t.prototype.createLoginBtn=function(){var t=new r({label:"Log in",onClick:function(){location.hash="#login"}}).render();return t.classList.add("main__login"),t},t.prototype.createTitle=function(){var t=document.createElement("h1");return t.textContent="RS Lang",t},t.prototype.createMainText=function(){var t=document.createElement("p");return t.className="main__subtitle",t.textContent="Learning English is much more interesting than it seems. It is enough to learn it along with our exciting games. We will help you fall in love with English! ",t},t.prototype.createMainBackground=function(){var t=document.createElement("img");return t.className="main__img",t.src="src/assets/images/main.svg",t},t.prototype.createMainContent=function(){var t=document.createElement("div");return t.className="main__wrap",t.append(this.createTitle(),this.createMainText(),this.createStartBtn()),t},t.prototype.createAbout=function(){var t=document.createElement("div");t.className="main__about";var e=document.createElement("h2");return e.className="main__about-subtitle",e.textContent="Application features",t.append(e,this.createImageBlock("textbook","The electronic textbook consists of six sections. Each section has 30 pages of 20 words. Here you can significantly expand your vocabulary.","Textbook"),this.createImageBlock("games","2 most popular games to improve your English listening and comprehension skills. Check how much points you can get in one minute, making educated guesses about what is right and what is wrong","Games"),this.createImageBlock("statistics","Thanks to statistics, you will not only see your progress, but also motivate yourself to better results.","Statistics")),t},t.prototype.createImageBlock=function(t,e,n){var r=document.createElement("div");r.className="main__info","games"===t&&r.classList.add("main__reverse");var o=document.createElement("div");o.className="main__text-wrap";var a=document.createElement("h2");a.className="main__about-title",a.textContent=n;var s=document.createElement("p");return s.className="main__about-text",s.textContent=e,o.append(a,s),r.append(this.createIcon(t),o),r},t.prototype.createAboutTeam=function(){var t=document.createElement("div");t.className="main__team";var e=document.createElement("h2");return e.className="main__about-subtitle",e.textContent="Our team",t.append(e,this.createImageBlock("","About","Ekaterina"),this.createImageBlock("","About","Artem"),this.createImageBlock("","About","Elena")),t},t.prototype.createIcon=function(t){var e=document.createElement("div");e.className="main__icon-wrap";var n=document.createElement("img");return n.className="main__about-img",n.src="src/assets/images/".concat(t,".svg"),e.append(n),e},t.prototype.render=function(){var t=document.createElement("div");t.className="main";var e=(new i).render();return t.append(this.createMainContent(),this.createMainBackground(),this.createLoginBtn(),this.createAbout(),this.createAboutTeam(),e),t},t}();const R=function(){function t(){this.userStat={optional:{new:0,sprint:{learned:0,correctAnswers:0,count:0,row:0},audio:{learned:0,correctAnswers:0,count:0,row:0}}},this.userId=localStorage.getItem("userID")}return t.prototype.createTitle=function(t){var e=document.createElement("h2");return e.className="statistics__title",e.textContent=t,e},t.prototype.createLoginBtn=function(){var t=new r({label:"Log in",onClick:function(){location.hash="#login"}}).render();return t.classList.add("main__login"),t},t.prototype.createStatBlock=function(t,e){var n=document.createElement("div");n.className="statistics__block";var r=document.createElement("span");r.className="statistics__stat",r.textContent=t;var o=document.createElement("span");return o.className="statistics__text",o.textContent=e,n.append(r,o),n},t.prototype.createMain=function(){var t=document.createElement("div");t.className="statistics__main";var e=document.createElement("p");e.className="statistics__subtitle",e.textContent="Today";var n=document.createElement("div");n.className="statistics__general";var r="".concat(this.userStat.optional.sprint.learned+this.userStat.optional.audio.learned||0),o=this.createStatBlock(r,"Learned words");o.classList.add("statistics__stat-big");var a="".concat(Math.round((this.userStat.optional.sprint.correctAnswers+this.userStat.optional.audio.correctAnswers)/(this.userStat.optional.sprint.count+this.userStat.optional.audio.count)*100)||0,"%"),s=this.createStatBlock(a,"Accuracy");s.classList.add("statistics__stat-big"),n.append(o,s);var i=document.createElement("div");return i.className="statistics__games",i.append(this.createGameBlock("Audio challenge","audio"),this.createGameBlock("Sprint","sprint")),t.append(e,n,i),t},t.prototype.createGameBlock=function(t,e){var n=document.createElement("div");n.className="statistics__game";var r=document.createElement("p");r.className="statistics__game__title",r.textContent=t;var o=document.createElement("div");return o.className="statistics__game-wrap","sprint"===e?o.append(this.createStatBlock("".concat(this.userStat.optional.sprint.learned||0),"Learned words"),this.createStatBlock("".concat(Math.round(this.userStat.optional.sprint.correctAnswers/this.userStat.optional.sprint.count*100)||0,"%"),"Accuracy"),this.createStatBlock("".concat(this.userStat.optional.sprint.row||0),"In a row")):o.append(this.createStatBlock("".concat(this.userStat.optional.audio.learned||0),"Learned words"),this.createStatBlock("".concat(Math.round(this.userStat.optional.audio.correctAnswers/this.userStat.optional.audio.count*100)||0,"%"),"Accuracy"),this.createStatBlock("".concat(this.userStat.optional.audio.row||0),"In a row")),n.append(r,o),n},t.prototype.getStatistics=function(){return t=this,e=void 0,r=function(){var t;return function(t,e){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}}(this,(function(e){switch(e.label){case 0:return[4,k(this.userId)];case 1:return(t=e.sent())&&(this.userStat=t),[2]}}))},new((n=void 0)||(n=Promise))((function(o,a){function s(t){try{c(r.next(t))}catch(t){a(t)}}function i(t){try{c(r.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,i)}c((r=r.apply(t,e||[])).next())}));var t,e,n,r},t.prototype.render=function(){var t=this,e=document.createElement("div");e.className="statistics";var n=(new i).render();return this.getStatistics().then((function(){e.append(t.createTitle("Statistics"),t.createMain(),n)})),localStorage.getItem("userID")||e.append(this.createLoginBtn()),e},t}();var M=function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function s(t){try{c(r.next(t))}catch(t){a(t)}}function i(t){try{c(r.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,i)}c((r=r.apply(t,e||[])).next())}))},U=function(t,e){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}};const G=function(){function t(){this.currentWord=null}return t.prototype.loadCurrentWord=function(t,e){return void 0===e&&(e={}),M(this,void 0,void 0,(function(){var n;return U(this,(function(r){return n=document.querySelector(".word"),this.currentWord||(this.currentWord=new I,n.append(this.currentWord.render())),this.currentWord.loadCurrentWord(t,e),[2]}))}))},t.prototype.loadWords=function(t,e,n){return M(this,void 0,void 0,(function(){var r,o,a,s=this;return U(this,(function(i){switch(i.label){case 0:return[4,w(e,n)];case 1:return r=i.sent(),localStorage.setItem("textbook-difficulty",e),localStorage.setItem("textbook-page",n),(o=localStorage.getItem("userID"))?[4,_(o)]:[3,3];case 2:a=i.sent(),i.label=3;case 3:for(;t.firstChild;)t.removeChild(t.firstChild);return document.querySelector(".pagination").classList.remove("pagination-invisible"),r.forEach((function(e,n){var o=document.createElement("div");o.className="words__item",o.setAttribute("data-id",e.id);var i=a.find((function(t){return t.wordId===e.id}));i&&s.setWordStatus(o,i.optional);var c=document.createElement("h4");c.textContent=e.word,c.className="words__word",o.append(c);var u=document.createElement("p");if(u.textContent=e.wordTranslate,u.className="words__translate",o.append(u),o.addEventListener("click",(function(t){var e=t.currentTarget.dataset,n=e.id,r=e.status;s.loadCurrentWord(n,{status:r})})),0===n)if(i){var l=i.optional.status;s.loadCurrentWord(r[n].id,{status:l})}else s.loadCurrentWord(r[n].id);t.append(o)})),[2]}}))}))},t.prototype.loadHardWords=function(t){return M(this,void 0,void 0,(function(){var e,n,r,o=this;return U(this,(function(a){switch(a.label){case 0:for(e=localStorage.getItem("userID");t.firstChild;)t.removeChild(t.firstChild);return document.querySelector(".pagination").classList.add("pagination-invisible"),e?[4,_(e)]:[3,2];case 1:n=a.sent(),r=[],n.forEach((function(t){"difficult"===t.optional.status&&r.push(t.wordId)})),r.forEach((function(e){o.createHardWord(t,e)})),a.label=2;case 2:return[2]}}))}))},t.prototype.createHardWord=function(t,e){return M(this,void 0,void 0,(function(){var n,r,o,a,s=this;return U(this,(function(i){switch(i.label){case 0:return[4,y(e)];case 1:return n=i.sent(),(r=document.createElement("div")).className="words__item",r.classList.add("words__item-hard"),r.setAttribute("data-id",n.id),r.setAttribute("data-status","hard"),(o=document.createElement("h4")).textContent=n.word,o.className="words__word",r.append(o),(a=document.createElement("p")).textContent=n.wordTranslate,a.className="words__translate",r.append(a),r.addEventListener("click",(function(t){var e=t.currentTarget.dataset,n=e.id,r=e.status;s.loadCurrentWord(n,{status:r})})),0===t.children.length&&this.loadCurrentWord(n.id),t.append(r),[2]}}))}))},t.prototype.setWordStatus=function(t,e){return M(this,void 0,void 0,(function(){return U(this,(function(n){return"difficult"===e.status&&t.classList.add("words__item-hard"),"learned"===e.status&&t.classList.add("words__item-learned"),t.setAttribute("data-status",e.status),[2]}))}))},t.prototype.createTitle=function(){var t=document.createElement("h2");return t.textContent="Textbook",t.className="textbook__title",t},t.prototype.createDifficultyLevels=function(){var t=new c(this.changeActiveDifficultyLevel.bind(this)).render(),e=localStorage.getItem("textbook-difficulty");return this.difficultyLevel="string"==typeof e?e:"0",t},t.prototype.changeActiveDifficultyLevel=function(t){var e=document.querySelector(".words__list");"hard"!==t?(this.difficultyLevel=t,this.loadWords(e,t,"0"),this.pagination.refreshActivePage("0")):this.loadHardWords(e)},t.prototype.createWordsList=function(t){var e=document.createElement("div");e.className="words__list";var n=localStorage.getItem("textbook-difficulty"),r=localStorage.getItem("textbook-page");"string"==typeof n&&"string"==typeof r?this.loadWords(e,n,r):this.loadWords(e,"0","0"),t.append(e)},t.prototype.createCurrentWord=function(t){return M(this,void 0,void 0,(function(){var e;return U(this,(function(n){return(e=document.createElement("div")).className="word",t.append(e),[2]}))}))},t.prototype.createDictionary=function(){var t=document.createElement("div");return t.className="words",this.createWordsList(t),this.createCurrentWord(t),t},t.prototype.createPagination=function(){var t=new N(this.changePage.bind(this));return this.pagination=t,t.render()},t.prototype.createGamesList=function(){var t=document.createElement("div");t.className="games-list";var e=document.createElement("h2");e.textContent="Games";var n=document.createElement("div");return n.className="games",n.append(this.createAudioBlock(),this.createSprintBlock()),t.append(e,n),t},t.prototype.createAudioBlock=function(){return new s({title:"Audio challenge",text:"Check your listening skills, trying to pick the right meaning after hearing a word. Be careful, as you just have one guess.",imgName:"listen.svg",onClick:function(){location.hash="#audioChallenge"}}).render()},t.prototype.createSprintBlock=function(){return new s({title:"Sprint",text:"Check how much points you can get in one minute, making educated guesses about what is right and what is wrong.",imgName:"sprint.svg",onClick:function(){location.hash="#sprint"}}).render()},t.prototype.changePage=function(t){var e=document.querySelector(".words__list");this.loadWords(e,this.difficultyLevel,t)},t.prototype.render=function(){var t=document.createElement("div");return t.className="textbook",t.append(this.createTitle(),this.createDifficultyLevels(),this.createDictionary(),this.createPagination(),this.createGamesList()),t},t}(),D=function(){function t(){}return t.prototype.createAudioBlock=function(){return new s({title:"Audio challenge",text:"Check your listening skills, trying to pick the right meaning after hearing a word. Be careful, as you just have one guess.",imgName:"listen.svg",onClick:function(){location.hash="#audioChallenge"}}).render()},t.prototype.createSprintBlock=function(){return new s({title:"Sprint",text:"Check how much points you can get in one minute, making educated guesses about what is right and what is wrong.",imgName:"sprint.svg",onClick:function(){location.hash="#sprint"}}).render()},t.prototype.createTitle=function(t){var e=document.createElement("h2");return e.className="games-wrap__title",e.textContent=t,e},t.prototype.createLoginBtn=function(){var t=new r({label:"Log in",onClick:function(){location.hash="#login"}}).render();return t.classList.add("main__login"),t},t.prototype.render=function(){var t=document.createElement("div");t.className="games-wrap";var e=document.createElement("div");e.className="games";var n=(new i).render();return e.append(this.createAudioBlock(),this.createSprintBlock()),t.append(this.createTitle("Minigames"),e,n),localStorage.getItem("userID")||t.append(this.createLoginBtn()),t},t}(),O=function(){function t(t){this.stop=t,this.timeCount=30,this.scoreCount=0,this.plusScoreCount=10,this.stop=t}return t.prototype.createTimer=function(){var t=document.createElement("div");t.className="sprint__time-wrap";var e=document.createElement("span");e.className="sprint__time",e.textContent="time:";var n=document.createElement("span");return n.className="sprint__time-count",n.textContent="30",this.timeElem=n,t.append(e,n),t},t.prototype.createScore=function(){var t=document.createElement("div");t.className="sprint__score-wrap";var e=document.createElement("span");e.className="sprint__score",e.textContent="score:";var n=document.createElement("span");return n.className="sprint__score-count",n.textContent="0",this.scoreElem=n,t.append(e,n),t},t.prototype.setTimer=function(){var t=this;setInterval((function(){t.timeElem.textContent="".concat(+t.timeElem.textContent-1),0==+t.timeElem.textContent&&t.stop()}),1e3)},t.prototype.updateScore=function(t){this.scoreElem.textContent="".concat(+this.scoreElem.textContent+t)},t.prototype.updatePlusScore=function(t){this.plusScoreElem.textContent="+".concat(t)},t.prototype.render=function(){var t=document.createElement("div");t.className="sprint__header";var e=document.createElement("p");return e.className="sprint__plus-score",e.textContent="+10",this.plusScoreElem=e,t.append(this.createTimer(),e,this.createScore()),t},t}(),j=function(){function t(t){this.data=t}return t.prototype.createTitle=function(){var t=document.createElement("div");t.className="game-stat__title-wrap";var e=document.createElement("h3");return e.className="game-stat__title",e.textContent="result",t.append(e),t},t.prototype.createMain=function(){var t=this,e=document.createElement("div");e.className="game-stat__main";var n=document.createElement("div");n.className="game-stat__stat-wrap";var r="".concat(Math.round(this.data.correct.length/(this.data.correct.length+this.data.wrong.length)*100)||0,"%");n.append(this.createStatBlock(r,"Accuracy"),this.createStatBlock("".concat(this.data.row),"In a row"));var o=document.createElement("div");o.className="game-stat__wrap";var a=document.createElement("p");a.className="game-stat__subtitle",a.textContent="Mistakes - ".concat(this.data.wrong.length),o.append(a),this.data.wrong.forEach((function(e){var n=document.createElement("div");n.className="game-stat__word-wrap";var r=document.createElement("button");r.className="game-stat__sound",r.addEventListener("click",(function(){var n=new Audio;n.src="https://react-learnwords2022.herokuapp.com/".concat(t.data.words[e].audio),n.play()}));var a=document.createElement("span");a.className="game-stat__word",a.textContent="".concat(t.data.words[e].word," ");var s=document.createElement("span");s.className="game-stat__translate",s.textContent=" - ".concat(t.data.words[e].translate),n.append(r,a,s),o.append(n)}));var s=document.createElement("p");return s.className="game-stat__subtitle",s.textContent="Correct answers - ".concat(this.data.correct.length),o.append(s),this.data.correct.forEach((function(e){var n=document.createElement("div");n.className="game-stat__word-wrap";var r=document.createElement("button");r.className="game-stat__sound",r.addEventListener("click",(function(){var n=new Audio;n.src="https://react-learnwords2022.herokuapp.com/".concat(t.data.words[e].audio),n.play()}));var a=document.createElement("span");a.className="game-stat__word",a.textContent="".concat(t.data.words[e].word," ");var s=document.createElement("span");s.className="game-stat__translate",s.textContent=" - ".concat(t.data.words[e].translate),n.append(r,a,s),o.append(n)})),e.append(n,o),e},t.prototype.createStatBlock=function(t,e){var n=document.createElement("div");n.className="game-stat__block";var r=document.createElement("span");r.className="game-stat__stat",r.textContent=t;var o=document.createElement("span");return o.className="game-stat__text",o.textContent=e,n.append(r,o),n},t.prototype.createNav=function(){var t=document.createElement("div");t.className="game-stat__btn-wrap";var e=new r({label:"play again",onClick:function(){window.location.hash="",window.location.hash="#sprint"}}).render(),n=new r({label:"textbook",onClick:function(){window.location.hash="#textbook"}}).render();return t.append(e,n),t},t.prototype.render=function(){return this.component=document.createElement("div"),this.component.className="game-stat",this.component.append(this.createTitle(),this.createMain(),this.createNav()),this.component},t}();var H=function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function s(t){try{c(r.next(t))}catch(t){a(t)}}function i(t){try{c(r.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,i)}c((r=r.apply(t,e||[])).next())}))},z=function(t,e){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}};const F=function(){function t(){this.wordsArray=[],this.correctWordsArray=[],this.currentWordIndex=0,this.userId=localStorage.getItem("userID")||null,this.correctAnswers=[],this.wrongAnswers=[],this.rowAnswer=0,this.currentRow=0,this.prevAnswer=!1,this.learnedWord=0,this.isSoundEnabled=!0,this.header=new O(this.stopGame.bind(this))}return t.prototype.createMain=function(){var t=document.createElement("div");return t.className="sprint__main",this.question=document.createElement("span"),this.question.className="sprint__question",this.question.textContent="?",t.append(this.createWords(),this.question,this.createButtons()),t},t.prototype.createButtons=function(){var t=document.createElement("div");return t.className="sprint__buttons",this.correctBtn=new r({label:"correct",onClick:this.onCorrectClick.bind(this)}).render(),this.wrongBtn=new r({label:"wrong",onClick:this.onWrongClick.bind(this)}).render(),t.append(this.correctBtn,this.wrongBtn),t},t.prototype.createWordStat=function(t){return H(this,void 0,void 0,(function(){var e;return z(this,(function(n){switch(n.label){case 0:return[4,b(this.userId,this.wordsArray[this.currentWordIndex].id)];case 1:return e=n.sent(),t?e?[3,3]:[4,S(this.userId,this.wordsArray[this.currentWordIndex].id,{difficulty:"easy",optional:{status:"simple",new:!0,sprint:{correctAnswers:1},audio:{correctAnswers:0}}})]:[3,8];case 2:return n.sent(),[3,7];case 3:return e.optional.sprint.correctAnswers+e.optional.audio.correctAnswers>2?(2===e.optional.sprint.correctAnswers&&(this.learnedWord+=1),[4,E(this.userId,this.wordsArray[this.currentWordIndex].id,{difficulty:"weak",optional:{status:"learned",sprint:{correctAnswers:e.optional.sprint.correctAnswers+=1}}})]):[3,5];case 4:return n.sent(),[3,7];case 5:return[4,E(this.userId,this.wordsArray[this.currentWordIndex].id,{difficulty:"weak",optional:{new:!0,sprint:{correctAnswers:e.optional.sprint?e.optional.sprint.correctAnswers+=1:1}}})];case 6:n.sent(),n.label=7;case 7:return[3,10];case 8:return e?[3,10]:[4,S(this.userId,this.wordsArray[this.currentWordIndex].id,{difficulty:"easy",optional:{status:"simple",new:!0,sprint:{correctAnswers:0},audio:{correctAnswers:0}}})];case 9:n.sent(),n.label=10;case 10:return[2]}}))}))},t.prototype.addStatistics=function(){return H(this,void 0,void 0,(function(){var t;return z(this,(function(e){switch(e.label){case 0:return[4,k(this.userId)];case 1:return(t=e.sent())?[4,x(this.userId,{optional:{new:0,sprint:{learned:t.optional.sprint.learned+this.learnedWord,correctAnswers:t.optional.sprint.correctAnswers+this.correctAnswers.length,count:t.optional.sprint.count+this.correctAnswers.length+this.wrongAnswers.length,row:t.optional.sprint.row+this.rowAnswer},audio:{learned:t.optional.audio.learned,correctAnswers:t.optional.audio.correctAnswers,count:t.optional.audio.count,row:t.optional.audio.row}}})]:[3,3];case 2:return e.sent(),[3,5];case 3:return[4,x(this.userId,{optional:{new:0,sprint:{learned:this.learnedWord,correctAnswers:this.correctAnswers.length,count:20,row:this.rowAnswer},audio:{learned:0,correctAnswers:0,count:0,row:0}}})];case 4:e.sent(),e.label=5;case 5:return[2]}}))}))},t.prototype.checkRowAnswers=function(t){t?(this.prevAnswer=!0,this.currentRow+=1):(this.prevAnswer=!1,this.rowAnswer>this.currentRow||(this.rowAnswer=this.currentRow),this.currentRow=0)},t.prototype.onCorrectClick=function(){var t=this;this.wordsArray[this.currentWordIndex].correct?(this.correctAnswers.push(this.currentWordIndex),this.checkRowAnswers(!0),this.playSound(!0),this.currentRow>=3&&this.currentRow<=5?(this.header.updateScore(20),this.header.updatePlusScore(20)):this.currentRow>=6?(this.header.updateScore(30),this.header.updatePlusScore(30)):(this.header.updateScore(10),this.header.updatePlusScore(10)),this.userId&&this.createWordStat(!0),this.question.classList.add("green"),this.correctBtn.disabled=!0,this.wrongBtn.disabled=!0,setTimeout((function(){t.question.classList.remove("green"),t.changeWordsContent(),t.correctBtn.disabled=!1,t.wrongBtn.disabled=!1}),1500)):(this.wrongAnswers.push(this.currentWordIndex),this.playSound(!1),this.checkRowAnswers(!1),this.header.updatePlusScore(10),this.userId&&this.createWordStat(!1),this.question.classList.add("red"),this.correctBtn.disabled=!0,this.wrongBtn.disabled=!0,setTimeout((function(){t.question.classList.remove("red"),t.changeWordsContent(),t.correctBtn.disabled=!1,t.wrongBtn.disabled=!1}),1500))},t.prototype.onWrongClick=function(){var t=this;this.wordsArray[this.currentWordIndex].correct?(this.wrongAnswers.push(this.currentWordIndex),this.playSound(!1),this.checkRowAnswers(!1),this.header.updatePlusScore(10),this.userId&&this.createWordStat(!1),this.question.classList.add("red"),this.correctBtn.disabled=!0,this.wrongBtn.disabled=!0,setTimeout((function(){t.question.classList.remove("red"),t.changeWordsContent(),t.correctBtn.disabled=!1,t.wrongBtn.disabled=!1}),1500)):(this.correctAnswers.push(this.currentWordIndex),this.checkRowAnswers(!0),this.playSound(!0),this.currentRow>=3&&this.currentRow<=5?(this.header.updateScore(20),this.header.updatePlusScore(20)):this.currentRow>=6?(this.header.updateScore(30),this.header.updatePlusScore(30)):(this.header.updateScore(10),this.header.updatePlusScore(10)),this.userId&&this.createWordStat(!0),this.question.classList.add("green"),this.correctBtn.disabled=!0,this.wrongBtn.disabled=!0,setTimeout((function(){t.question.classList.remove("green"),t.changeWordsContent(),t.correctBtn.disabled=!1,t.wrongBtn.disabled=!1}),1500))},t.prototype.changeWordsContent=function(){this.currentWordIndex+=1,20!==this.currentWordIndex?(this.wordEn.textContent="".concat(this.wordsArray[this.currentWordIndex].word),this.wordRu.textContent="".concat(this.wordsArray[this.currentWordIndex].translate)):this.stopGame()},t.prototype.createWords=function(){var t=document.createElement("div");return t.className="sprint__words",this.equally=document.createElement("span"),this.equally.className="sprint__equally",this.equally.textContent="=",t.append(this.createWordEn(),this.equally,this.createWordRu()),t},t.prototype.createWordEn=function(){var t=document.createElement("div");return t.className="sprint__wrap",this.wordEn=document.createElement("span"),this.wordEn.className="sprint__word-en sprint__word",this.wordEn.textContent="".concat(this.wordsArray[this.currentWordIndex].word),t.append(this.wordEn),t},t.prototype.createWordRu=function(){var t=document.createElement("div");return t.className="sprint__wrap",this.wordRu=document.createElement("span"),this.wordRu.className="sprint__word-ru sprint__word",this.wordRu.textContent="".concat(this.wordsArray[this.currentWordIndex].translate),t.append(this.wordRu),t},t.prototype.randomInteger=function(t,e){var n=t+Math.random()*(e+1-t);return Math.floor(n)},t.prototype.createWordsArray=function(){for(var t=this,e=new Set;e.size<8;){var n=this.randomInteger(0,19);e.add(n)}for(;e.size<20;)n=this.randomInteger(0,19),e.add(n);e.forEach((function(e){if(t.wordsArray.length<8){var n={word:t.words[+e].word,translate:t.words[+e].wordTranslate,correct:!0,id:t.words[+e].id,audio:t.words[+e].audio};t.wordsArray.push(n)}else n={word:t.words[+e].word,translate:t.wordsWrong[+e].wordTranslate,correct:!1,id:t.words[+e].id,audio:t.words[+e].audio},t.wordsArray.push(n)})),this.correctWordsArray=JSON.parse(JSON.stringify(this.wordsArray)),this.shuffleObject(this.wordsArray),console.log(this.wordsArray),this.startGame()},t.prototype.shuffleObject=function(t){for(var e,n=t.length-1;n>0;n-=1){var r=Math.floor(Math.random()*(n+1));e=[t[r],t[n]],t[n]=e[0],t[r]=e[1]}},t.prototype.createTitle=function(t){var e=document.createElement("h2");return e.className="sprint__title",e.textContent=t,e},t.prototype.createLoginBtn=function(){var t=new r({label:"Log in",onClick:function(){location.hash="#login"}}).render();return t.classList.add("main__login"),t},t.prototype.getWords=function(t){return H(this,void 0,void 0,(function(){var e,n,r,o;return z(this,(function(a){switch(a.label){case 0:return this.levelElem.remove(),e=this.randomInteger(0,29).toString(),n=this.randomInteger(0,29).toString(),r=this,[4,w(t,e)];case 1:return r.words=a.sent(),o=this,[4,w(t,n)];case 2:return o.wordsWrong=a.sent(),this.createWordsArray(),[2]}}))}))},t.prototype.getWordsTextBook=function(t,e){return H(this,void 0,void 0,(function(){var n,r,o;return z(this,(function(a){switch(a.label){case 0:return this.levelElem.remove(),n=this.randomInteger(0,29).toString(),r=this,[4,w(t,e)];case 1:return r.words=a.sent(),o=this,[4,w(t,n)];case 2:return o.wordsWrong=a.sent(),this.createWordsArray(),[2]}}))}))},t.prototype.startGame=function(){var t=this.header.render();this.sprintWrap=document.createElement("div"),this.sprintWrap.className="sprint__wrapper",this.sprintWrap.append(t,this.createMain()),this.component.append(this.sprintWrap),this.header.setTimer()},t.prototype.stopGame=function(){this.addStatistics(),this.sprintWrap.remove();var t=new j({correct:this.correctAnswers,wrong:this.wrongAnswers,words:this.correctWordsArray,row:this.rowAnswer}).render();this.component.append(t)},t.prototype.playSound=function(t){if(this.isSoundEnabled){var e=new Audio;e.src=t?"src/assets/sounds/yes.mp3":"src/assets/sounds/no.mp3",e.play()}},t.prototype.createToolBar=function(){var t=this,e=document.createElement("div");e.className="sprint__icon-wrap";var n=document.createElement("img");n.className="sprint__sound",n.src="src/assets/images/play-audio.svg";var r=document.createElement("img");return r.className="sprint__screen",r.src="src/assets/images/fullscreen.svg",n.addEventListener("click",(function(){t.isSoundEnabled=!t.isSoundEnabled})),r.addEventListener("click",(function(){document.fullscreenElement?document.exitFullscreen():t.component.requestFullscreen()})),e.append(n,r),e},t.prototype.render=function(){if(this.component=document.createElement("div"),this.component.className="sprint",this.levelElem=new c(this.getWords.bind(this)).render(),"textbook"===localStorage.getItem("page")){this.component.append(this.createTitle("Sprint"),this.createToolBar());var t=localStorage.getItem("textbook-difficulty"),e=localStorage.getItem("textbook-page");this.getWordsTextBook(t,e)}else this.component.append(this.createTitle("Sprint"),this.createToolBar(),this.levelElem);return localStorage.getItem("userID")||this.component.append(this.createLoginBtn()),this.component},t}();var J,K=function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function s(t){try{c(r.next(t))}catch(t){a(t)}}function i(t){try{c(r.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,i)}c((r=r.apply(t,e||[])).next())}))},Z=function(t,e){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}},V=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,a=e.length;o<a;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},$=function(){function t(){var t=this;this.userId=localStorage.getItem("userID")||null,this.correctArr=function(){return t.arrayGame.filter((function(t){return t.correctAnswer>0}))},this.wrongArr=function(){return t.arrayGame.filter((function(t){return 0===t.correctAnswer}))},this.header=new O((function(){return console.log(" ")})),this.data=[],this.arrayGame=[],this.currentIndexWord=-1,this.isAnswer=!0,this.currentSeries=0,this.greatestSeries=0,this.score=0,this.scoreUpdate=10,this.learnedWord=0}return t.prototype.getWords=function(t){return K(this,void 0,void 0,(function(){var e,n,r=this;return Z(this,(function(o){switch(o.label){case 0:return this.data.length=0,e=Array.from({length:30},(function(t,e){return e})),n=e.map((function(e){return w(t,e.toString())})),[4,Promise.all(n)];case 1:return o.sent().forEach((function(t){var e;return(e=r.data).push.apply(e,t)})),[2]}}))}))},t.prototype.getArrayGame=function(){return K(this,void 0,void 0,(function(){var t,e=this;return Z(this,(function(n){return t=Array.from({length:20},(function(){return e.getRandomNum(600)})),t=V([],this.checkArray(t,600),!0),this.arrayGame=t.map((function(t){return Object.assign(e.data[t],{correctAnswer:0})})),[2]}))}))},t.prototype.getRandomNum=function(t){return Math.floor(Math.random()*t)},t.prototype.checkArray=function(t,e){for(var n=V([],t,!0),r=0;r<=n.length-1;r+=1)if(n.indexOf(n[r],r+1)>0)return n[r]=this.getRandomNum(e),this.checkArray(n,e);return n},t.prototype.changeButton=function(){var t=document.querySelector(".challenge__button");null!==t&&this.isAnswer?t.textContent="next word":null===t||this.isAnswer||(t.textContent="I don't know")},t.prototype.showAnswer=function(){return K(this,void 0,void 0,(function(){var t,e;return Z(this,(function(n){switch(n.label){case 0:return this.currentIndexWord>=0?(this.scoreUpdate=10,t=this.arrayGame[this.currentIndexWord].wordTranslate,document.querySelectorAll(".challenge__answer").forEach((function(n){t===n.textContent.split(".")[1].trim()&&(e=n)})),e.classList.add("challenge__correct-answer"),this.userId?[4,this.createWordStat(!1)]:[3,2]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.checkAnswer=function(t){return K(this,void 0,void 0,(function(){var e;return Z(this,(function(n){switch(n.label){case 0:return this.isAnswer=!0,null===t?[3,5]:(e=t.textContent.split(".")[1].trim(),this.arrayGame[this.currentIndexWord].wordTranslate!==e?[3,3]:(this.currentSeries+=1,this.currentSeries>this.greatestSeries&&(this.greatestSeries=this.currentSeries),this.changeButton(),this.updateScore(),this.arrayGame[this.currentIndexWord].correctAnswer+=1,t.classList.add("challenge__correct-answer"),this.userId?[4,this.createWordStat(!0)]:[3,2]));case 1:n.sent(),n.label=2;case 2:return[3,5];case 3:return this.currentSeries=0,t.classList.add("challenge__incorrect-answer"),this.arrayGame[this.currentIndexWord].correctAnswer=0,this.scoreUpdate=10,this.updateScorePlus(),this.changeButton(),[4,this.showAnswer()];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.updateScore=function(){this.currentSeries>=3&&this.currentSeries<=5?(this.score+=20,this.scoreUpdate=20):this.currentSeries>=6?(this.score+=30,this.scoreUpdate=30):(this.score+=10,this.scoreUpdate=10),document.querySelector(".sprint__score-count").textContent="".concat(this.score)},t.prototype.updateScorePlus=function(){document.querySelector(".sprint__plus-score").textContent="+".concat(this.scoreUpdate)},t.prototype.playAudio=function(){var t=document.querySelector(".challenge__play-audio"),e=this.arrayGame[this.currentIndexWord].audio,n=new Audio;n.src="https://react-learnwords2022.herokuapp.com/".concat(e),n.addEventListener("canplay",(function(){n.play(),t.disabled=!0})),n.addEventListener("ended",(function(){t.disabled=!1}))},t.prototype.createWordStat=function(t){return K(this,void 0,void 0,(function(){var e;return Z(this,(function(n){switch(n.label){case 0:return[4,b(this.userId,this.arrayGame[this.currentIndexWord].id)];case 1:return e=n.sent(),console.log(e),t?e?[3,3]:[4,S(this.userId,this.arrayGame[this.currentIndexWord].id,{difficulty:"easy",optional:{status:"simple",new:!0,sprint:{correctAnswers:0},audio:{correctAnswers:1}}})]:[3,8];case 2:return n.sent(),[3,7];case 3:return e.optional.sprint.correctAnswers+e.optional.audio.correctAnswers>2?(2===e.optional.audio.correctAnswers&&(this.learnedWord+=1),[4,E(this.userId,this.arrayGame[this.currentIndexWord].id,{difficulty:"weak",optional:{status:"learned",sprint:{correctAnswers:e.optional.sprint.correctAnswers},audio:{correctAnswers:e.optional.audio.correctAnswers+=1}}})]):[3,5];case 4:return n.sent(),[3,7];case 5:return[4,E(this.userId,this.arrayGame[this.currentIndexWord].id,{difficulty:"weak",optional:{new:!0,sprint:{correctAnswers:e.optional.sprint.correctAnswers},audio:{correctAnswers:e.optional.audio?e.optional.audio.correctAnswers+=1:1}}})];case 6:n.sent(),n.label=7;case 7:return[3,10];case 8:return e?[3,10]:[4,S(this.userId,this.arrayGame[this.currentIndexWord].id,{difficulty:"easy",optional:{status:"simple",new:!0,sprint:{correctAnswers:0},audio:{correctAnswers:0}}})];case 9:n.sent(),n.label=10;case 10:return[2]}}))}))},t.prototype.addStatistics=function(){return K(this,void 0,void 0,(function(){var t;return Z(this,(function(e){switch(e.label){case 0:return[4,k(this.userId)];case 1:return(t=e.sent())?[4,x(this.userId,{optional:{new:0,sprint:{learned:t.optional.sprint.learned,correctAnswers:t.optional.sprint.correctAnswers,count:t.optional.sprint.count,row:t.optional.sprint.row},audio:{learned:t.optional.audio.learned+this.learnedWord,correctAnswers:t.optional.audio.correctAnswers+this.correctArr().length,count:t.optional.audio.count+this.correctArr().length+this.wrongArr().length,row:this.greatestSeries>t.optional.audio.row?this.greatestSeries:t.optional.audio.row}}})]:[3,3];case 2:return e.sent(),[3,5];case 3:return[4,x(this.userId,{optional:{new:0,sprint:{learned:0,correctAnswers:0,count:0,row:0},audio:{learned:this.learnedWord,correctAnswers:this.correctArr().length,count:20,row:this.greatestSeries}}})];case 4:e.sent(),e.label=5;case 5:return[2]}}))}))},t}(),Q=(J=function(t,e){return J=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},J(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}J(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),X=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,a=e.length;o<a;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};const Y=function(t){function e(){var e=t.call(this)||this;return e.isListener=!1,e.listeners=function(n){switch(n.code){case"Digit1":t.prototype.checkAnswer.call(e,document.querySelector(".challenge__answer-1"));break;case"Digit2":t.prototype.checkAnswer.call(e,document.querySelector(".challenge__answer-2"));break;case"Digit3":t.prototype.checkAnswer.call(e,document.querySelector(".challenge__answer-3"));break;case"Digit4":t.prototype.checkAnswer.call(e,document.querySelector(".challenge__answer-4"))}clearInterval(e.intervalId),e.removeListeners()},e.spaceListener=function(t){"Space"===t.code&&!1===t.repeat&&e.roundGame()},e.answerCheck=function(n){clearInterval(e.intervalId);var r=n.currentTarget;t.prototype.checkAnswer.call(e,r),e.removeListeners()},e}return Q(e,t),e.prototype.roundGame=function(){if(this.isListener||(document.addEventListener("keydown",this.listeners),this.isListener=!0),this.isAnswer)if(this.isAnswer=!1,t.prototype.changeButton.call(this),this.currentIndexWord<19){this.currentIndexWord+=1,this.renderGameRound(),t.prototype.playAudio.call(this),this.setTimer();var e=document.querySelector(".sprint__score-count");t.prototype.updateScorePlus.call(this),e.textContent="".concat(this.score)}else this.score=0,this.scoreUpdate=10,this.currentIndexWord=-1,this.showResult(),this.isAnswer=!0,document.removeEventListener("keydown",this.spaceListener);else this.isAnswer=!0,this.removeListeners(),clearInterval(this.intervalId),this.changeButton(),t.prototype.showAnswer.call(this)},e.prototype.removeListeners=function(){var t=this;this.isListener=!1,document.removeEventListener("keydown",this.listeners),document.querySelectorAll(".challenge__answer").forEach((function(e){return e.removeEventListener("click",t.answerCheck)}))},e.prototype.showResult=function(){this.isListener=!1;for(var e=document.querySelector(".challenge");e.firstChild;)e.removeChild(e.firstChild);var n=new C(this.startGame.bind(this),this.correctArr(),this.wrongArr(),this.greatestSeries,this.learnedWord).render();e.append(n),this.userId&&t.prototype.addStatistics.call(this)},e.prototype.createAnswerDiv=function(t,e){var n=document.createElement("div");return n.className="challenge__answer ".concat(e),n.textContent=t,n.addEventListener("click",this.answerCheck),n},e.prototype.createNextButton=function(){var t=new r({label:"I don't no",onClick:this.roundGame.bind(this)}).render();return t.classList.add("challenge__button"),t},e.prototype.createAudioButton=function(){var e=new r({label:"",onClick:t.prototype.playAudio.bind(this)}).render();return e.className="challenge__play-audio",e},e.prototype.setTimer=function(){var t=this,e=document.querySelector(".sprint__time-count");e.textContent="15",this.intervalId=setInterval((function(){e.textContent="".concat(+e.textContent-1).padStart(2,"0"),0==+e.textContent&&t.clearTimer()}),1e3)},e.prototype.clearTimer=function(){clearInterval(this.intervalId),this.showAnswer(),this.isAnswer=!0,t.prototype.changeButton.call(this),this.removeListeners()},e.prototype.renderGameRound=function(){for(var e=this,n=document.querySelector(".challenge__answers");n.firstChild;)n.removeChild(n.firstChild);var r=Array.from({length:3},(function(){return t.prototype.getRandomNum.call(e,20)}));return r.push(this.currentIndexWord),r=X([],t.prototype.checkArray.call(this,r,20),!0),r=X([],r.sort((function(){return Math.random()-.5})),!0),n.append(this.createAnswerDiv("1. ".concat(this.arrayGame[r[0]].wordTranslate),"challenge__answer-1"),this.createAnswerDiv("2. ".concat(this.arrayGame[r[1]].wordTranslate),"challenge__answer-2"),this.createAnswerDiv("3. ".concat(this.arrayGame[r[2]].wordTranslate),"challenge__answer-3"),this.createAnswerDiv("4. ".concat(this.arrayGame[r[3]].wordTranslate),"challenge__answer-4")),n},e.prototype.renderGame=function(){for(var t=document.querySelector(".challenge");t.firstChild;)t.removeChild(t.firstChild);var e=document.createElement("div");return e.className="challenge__answers",t.append(this.header.render(),this.createAudioButton(),e,this.createNextButton()),localStorage.getItem("userID")||t.append(this.createLoginBtn()),t},e.prototype.createLoginBtn=function(){var t=new r({label:"Log in",onClick:function(){location.hash="#login"}}).render();return t.classList.add("main__login"),t},e.prototype.startGame=function(){this.learnedWord=0,this.renderGame(),this.roundGame(),document.addEventListener("keydown",this.spaceListener),document.addEventListener("keyup",(function(t){return t.preventDefault()}))},e.prototype.getWord=function(e){return n=this,r=void 0,a=function(){return function(t,e){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}}(this,(function(n){switch(n.label){case 0:return[4,t.prototype.getWords.call(this,e)];case 1:return n.sent(),[4,t.prototype.getArrayGame.call(this)];case 2:return n.sent(),this.startGame(),[2]}}))},new((o=void 0)||(o=Promise))((function(t,e){function s(t){try{c(a.next(t))}catch(t){e(t)}}function i(t){try{c(a.throw(t))}catch(t){e(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(s,i)}c((a=a.apply(n,r||[])).next())}));var n,r,o,a},e.prototype.render=function(){var t=document.createElement("div");t.className="challenge";var e=new c(this.getWord.bind(this)).render();return t.append(e),localStorage.getItem("userID")||t.append(this.createLoginBtn()),t},e}($),tt=function(){function t(t,e){this.controller=t,this.root=e,this.appPage=null,this.nav=null,this.content=null,this.createRoot(e),this.loginPage=new q,this.loginPage.getUser()}return t.prototype.changePage=function(t){switch(t.slice(1)){case"main":this.appPage=(new P).render();break;case"textbook":this.appPage=(new G).render();break;case"minigames":this.appPage=(new D).render();break;case"statistics":this.appPage=(new R).render();break;case"login":this.appPage=this.loginPage.render();break;case"sprint":this.appPage=(new F).render();break;case"audioChallenge":this.appPage=(new Y).render()}this.content.innerHTML="",this.content.append(this.appPage),this.updateLink(t)},t.prototype.createRoot=function(t){var e=document.createElement("div");e.className="wrapper";var n=(new a).render();this.nav=n;var r=document.createElement("div");r.className="content",this.content=r,e.append(n,r),t.append(e)},t.prototype.updateLink=function(t){document.querySelectorAll(".menu__link").forEach((function(e){t===e.getAttribute("href")?e.classList.add("active"):e.classList.remove("active")}))},t}(),et=function(){function t(t){var n=this;this.root=t,this.model=new e(this),this.view=new tt(this,this.root),window.addEventListener("hashchange",(function(){n.changePage(location.hash),localStorage.setItem("page",location.hash.slice(1))})),this.checkPage()}return t.prototype.checkPage=function(){var t;location.hash?this.changePage(location.hash):(t="main",window.location.hash=t)},t.prototype.changePage=function(t){this.view.changePage(t)},t.prototype.getStore=function(){return this.model.getStore()},t.prototype.setStore=function(t){this.model.setStore(t)},t}();new et(document.querySelector(".root"))})();